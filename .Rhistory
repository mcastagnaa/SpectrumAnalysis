"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")],
RollingObs, mean, fill=NA)))
colnames(RollFuExpAv)[1] <- "Date"
RollFuExpAv$Date <- as.Date(RollFuExpAv$Date)
EquityExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="BySecGroup" &
SpecExpSet$Typ == "Equities",],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(EquityExp) <- c("Date",
"Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")
RollEqExpAv <- data.frame(cbind(EquityExp$Date,
rollapplyr(EquityExp[c("Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")],
RollingObs, mean, fill=NA)))
colnames(RollEqExpAv)[1] <- "Date"
RollEqExpAv$Date <- as.Date(RollEqExpAv$Date)
###########################
## Pick the "right" exposure variable
## RollFuExAv for equity funds exposure
## RollEqExAv for equity exposure
ExpRollMelt <- melt(RollFuExpAv, id.var = c("Date"), value.name = "Exposure")
###########################
Returns <- subset(CombByDate, select = c(Date,
Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret)
)
RollRetSd <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("Spec3Ret",
"Spec4Ret",
"Spec5Ret",
"Spec6Ret",
"Spec7Ret",
"Spec8Ret")],
RollingObs, sd, fill=NA)))
colnames(RollRetSd)[1] <- "Date"
RollRetSd$Date <- as.Date(RollRetSd$Date)
RetSdRollMelt <- melt(RollRetSd, id.var=c("Date"), value.name = "SdRet")
############
RegSet <- merge(ExpRollMelt, RetSdRollMelt, by = "Date")
View(RegSet)
summary(lm(SdRet ~ Exposure))
summary(lm(SdRet ~ Exposure, data = RegSet))
plot(SdRet ~ Exposure, data = RegSet))
plot(SdRet ~ Exposure, data = RegSet)
ExpRollMelt <- melt(RollEqExpAv, id.var = c("Date"), value.name = "Exposure")
###########################
Returns <- subset(CombByDate, select = c(Date,
Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret)
)
RollRetSd <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("Spec3Ret",
"Spec4Ret",
"Spec5Ret",
"Spec6Ret",
"Spec7Ret",
"Spec8Ret")],
RollingObs, sd, fill=NA)))
colnames(RollRetSd)[1] <- "Date"
RollRetSd$Date <- as.Date(RollRetSd$Date)
RetSdRollMelt <- melt(RollRetSd, id.var=c("Date"), value.name = "SdRet")
############
RegSet <- merge(ExpRollMelt, RetSdRollMelt, by = "Date")
plot(SdRet ~ Exposure, data = RegSet))
plot(SdRet ~ Exposure, data = RegSet)
summary(lm(SdRet ~ Exposure, data = RegSet))
library(reshape2)
library(PerformanceAnalytics)
rm(list =ls(all=TRUE))
load("SpecExpSet.Rda")
load("CombByDate.Rda")
RollingObs <- 20
FundsExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="ByFundType" &
SpecExpSet$Typ == "Equity Fund",],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(FundsExp) <- c("Date",
"Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")
RollFuExpAv <- data.frame(cbind(FundsExp$Date,
rollapplyr(FundsExp[c("Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")],
RollingObs, mean, fill=NA)))
colnames(RollFuExpAv)[1] <- "Date"
RollFuExpAv$Date <- as.Date(RollFuExpAv$Date)
EquityExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="BySecGroup" &
SpecExpSet$Typ == "Equities",],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(EquityExp) <- c("Date",
"Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")
RollEqExpAv <- data.frame(cbind(EquityExp$Date,
rollapplyr(EquityExp[c("Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")],
RollingObs, mean, fill=NA)))
colnames(RollEqExpAv)[1] <- "Date"
RollEqExpAv$Date <- as.Date(RollEqExpAv$Date)
###########################
## Pick the "right" exposure variable
## RollFuExAv for equity funds exposure
## RollEqExAv for equity exposure
ExpRollMelt <- melt(RollEqExpAv, id.var = c("Date"), value.name = "Exposure")
###########################
Returns <- subset(CombByDate, select = c(Date,
Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret)
)
RollRetSd <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("Spec3Ret",
"Spec4Ret",
"Spec5Ret",
"Spec6Ret",
"Spec7Ret",
"Spec8Ret")],
RollingObs, sd, fill=NA)))
colnames(RollRetSd)[1] <- "Date"
RollRetSd$Date <- as.Date(RollRetSd$Date)
RetSdRollMelt <- melt(RollRetSd, id.var=c("Date"), value.name = "SdRet")
############
RegSet <- merge(ExpRollMelt, RetSdRollMelt, by = "Date")
plot(EquityExp)
boxplot(EquityExp)
boxplot(EquityExp[,-1])
boxplot(FundsExp[,-1])
FundsExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="ByFundType" &
SpecExpSet$Typ == "Equity Fund" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(FundsExp) <- c("Date",
"Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")
boxplot(FundsExp[,-1])
boxplot(FundsExp[,-1],xaxt="n")
labs <- paste(names(FundsExp[,-1]), "Funds")
boxplot(FundsExp[,-1],xaxt="n")
labs <- paste(names(FundsExp[,-1]), "Funds")
text(cex=1, x=x-.25, y=-1.25, labs, xpd=TRUE, srt=45, pos=2)
x <- boxplot(FundsExp[,-1],xaxt="n")
labs <- paste(names(FundsExp[,-1]), "Funds")
text(cex=1, x=x-.25, y=-1.25, labs, xpd=TRUE, srt=45, pos=2)
text(labs, xpd=TRUE, srt=45, pos=2)
boxplot(FundsExp[,-1], las = 2)
library(ggplot2)
EquityExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="BySecGroup" &
SpecExpSet$Typ == "Equities",
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(EquityExp) <- c("Date",
"Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")
ggplot(boxplot(EquityExp[,-1], las = 2)
boxplot(FundsExp[,-1])
boxplot(EquityExp[,-1], las = 2)
plot(EquityExp[,-1] ~ EquityExp[,1], las = 2)
plot(EquityExp[,2] ~ EquityExp[,1], las = 2)
plot(EquityExp[,3] ~ EquityExp[,1], las = 2)
plot(EquityExp[,4] ~ EquityExp[,1], las = 2)
View(CombByDate)
View(SpecExpSet)
boxplot(FundsExp[,-1], las = 2)
library(reshape2)
library(PerformanceAnalytics)
rm(list =ls(all=TRUE))
load("SpecExpSet.Rda")
load("CombByDate.Rda")
RollingObs <- 20
FundsExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="ByFundType" &
SpecExpSet$Typ == "Equity Fund" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(FundsExp) <- c("Date",
"Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")
RollFuExpAv <- data.frame(cbind(FundsExp$Date,
rollapplyr(FundsExp[c("Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")],
RollingObs, mean, fill=NA)))
colnames(RollFuExpAv)[1] <- "Date"
RollFuExpAv$Date <- as.Date(RollFuExpAv$Date)
EquityExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="BySecGroup" &
SpecExpSet$Typ == "Equities",
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(EquityExp) <- c("Date",
"Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")
RollEqExpAv <- data.frame(cbind(EquityExp$Date,
rollapplyr(EquityExp[c("Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")],
RollingObs, mean, fill=NA)))
colnames(RollEqExpAv)[1] <- "Date"
RollEqExpAv$Date <- as.Date(RollEqExpAv$Date)
###########################
## Pick the "right" exposure variable
## RollFuExAv for equity funds exposure
## RollEqExAv for equity exposure
ExpRollMelt <- melt(RollFuExpAv, id.var = c("Date"), value.name = "Exposure")
###########################
Returns <- subset(CombByDate, select = c(Date,
Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret)
)
RollRetSd <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("Spec3Ret",
"Spec4Ret",
"Spec5Ret",
"Spec6Ret",
"Spec7Ret",
"Spec8Ret")],
RollingObs, sd, fill=NA)))
colnames(RollRetSd)[1] <- "Date"
RollRetSd$Date <- as.Date(RollRetSd$Date)
RetSdRollMelt <- melt(RollRetSd, id.var=c("Date"), value.name = "SdRet")
############
RegSet <- merge(ExpRollMelt, RetSdRollMelt, by = "Date")
boxplot(FundsExp[,-1], las = 2)
View(RollFuExpAv)
View(ExpRollMelt)
View(ExpRollMelt)
ggplot(ExpRollMelt, aes(x=variable, y = Exposure)) +
geom_boxplot() +
theme(axis.text.x = element_test(angle = 90, vjust = 0.5))
ggplot(ExpRollMelt, aes(x=variable, y = Exposure)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
ggplot(ExpRollMelt, aes(x=variable, y = Exposure)) +
xlabel = "Funds" +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
ggplot(ExpRollMelt, aes(x=variable, y = Exposure)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
axis.title.x = "Funds")
ggplot(ExpRollMelt, aes(x=variable, y = Exposure)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
xlab("Funds")
View(RetSdRollMelt)
ggplot(RetSdRollMelt, aes(x=variable, y = SdRet)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
xlab("Funds")
library(reshape2)
library(PerformanceAnalytics)
rm(list =ls(all=TRUE))
load("SpecExpSet.Rda")
load("CombByDate.Rda")
RollingObs <- 20
FundsExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="ByFundType" &
SpecExpSet$Typ == "Equity Fund" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(FundsExp) <- c("Date",
"Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")
RollFuExpAv <- data.frame(cbind(FundsExp$Date,
rollapplyr(FundsExp[c("Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")],
RollingObs, mean, fill=NA)))
colnames(RollFuExpAv)[1] <- "Date"
RollFuExpAv$Date <- as.Date(RollFuExpAv$Date)
EquityExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="BySecGroup" &
SpecExpSet$Typ == "Equities",
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(EquityExp) <- c("Date",
"Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")
RollEqExpAv <- data.frame(cbind(EquityExp$Date,
rollapplyr(EquityExp[c("Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")],
RollingObs, mean, fill=NA)))
colnames(RollEqExpAv)[1] <- "Date"
RollEqExpAv$Date <- as.Date(RollEqExpAv$Date)
###########################
## Pick the "right" exposure variable
## RollFuExAv for equity funds exposure
## RollEqExAv for equity exposure
ExpRollMelt <- melt(RollFuExpAv, id.var = c("Date"), value.name = "Exposure")
###########################
Returns <- subset(CombByDate, select = c(Date,
Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret)
)
RollRetSd <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("Spec3Ret",
"Spec4Ret",
"Spec5Ret",
"Spec6Ret",
"Spec7Ret",
"Spec8Ret")],
RollingObs, sd, fill=NA)))
colnames(RollRetSd)[1] <- "Date"
RollRetSd$Date <- as.Date(RollRetSd$Date)
RetSdRollMelt <- melt(RollRetSd, id.var=c("Date"), value.name = "SdRet")
############
RegSet <- merge(ExpRollMelt, RetSdRollMelt, by = "Date")
library(reshape2)
library(PerformanceAnalytics)
rm(list =ls(all=TRUE))
load("SpecExpSet.Rda")
load("CombByDate.Rda")
RollingObs <- 20
FundsExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="ByFundType" &
SpecExpSet$Typ == "Equity Fund" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(FundsExp) <- c("Date",
"Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")
RollFuExpAv <- data.frame(cbind(FundsExp$Date,
rollapplyr(FundsExp[c("Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")],
RollingObs, mean, fill=NA)))
colnames(RollFuExpAv)[1] <- "Date"
RollFuExpAv$Date <- as.Date(RollFuExpAv$Date)
EquityExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="BySecGroup" &
SpecExpSet$Typ == "Equities"&
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(EquityExp) <- c("Date",
"Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")
RollEqExpAv <- data.frame(cbind(EquityExp$Date,
rollapplyr(EquityExp[c("Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")],
RollingObs, mean, fill=NA)))
colnames(RollEqExpAv)[1] <- "Date"
RollEqExpAv$Date <- as.Date(RollEqExpAv$Date)
###########################
## Pick the "right" exposure variable
## RollFuExAv for equity funds exposure
## RollEqExAv for equity exposure
ExpRollMelt <- melt(RollFuExpAv, id.var = c("Date"), value.name = "Exposure")
###########################
Returns <- subset(CombByDate, select = c(Date,
Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret)
)
RollRetSd <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("Spec3Ret",
"Spec4Ret",
"Spec5Ret",
"Spec6Ret",
"Spec7Ret",
"Spec8Ret")],
RollingObs, sd, fill=NA)))
colnames(RollRetSd)[1] <- "Date"
RollRetSd$Date <- as.Date(RollRetSd$Date)
RetSdRollMelt <- melt(RollRetSd, id.var=c("Date"), value.name = "SdRet")
############
RegSet <- merge(ExpRollMelt, RetSdRollMelt, by = "Date")
View(RegSet)
summary(lm(SdRet ~ Exposure))
summary(lm(SdRet ~ Exposure, data = RegSet))
