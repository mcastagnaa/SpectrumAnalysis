Spec6Ret <- c(NA, Mid.SKSPEC6[2:n]/Mid.SKSPEC6[1:n-1]-1)
Spec7Ret <- c(NA, Mid.SKSPEC7[2:n]/Mid.SKSPEC7[1:n-1]-1)
Spec8Ret <- c(NA, Mid.SKSPEC8[2:n]/Mid.SKSPEC8[1:n-1]-1)
})
CombByDate <-merge(FundPRes, SectorRet, by = "Date", all = FALSE)
rownames(CombByDate) <- CombByDate$Date
firstDate <- min(CombByDate$Date)
lastDate <- max(CombByDate$Date)
Frequency(CombByDate)
Frequency(CombByDate$Spec3Ret)
Frequency(CombByDate[,1,drop=FALSE])
sd(CombByDate$Spec3Ret)
sd(CombByDate$Spec3Ret, na.rm = TRUE)
library(PerformanceAnalytics)
library(Hmisc)
RetSet <- subset(CombByDate, select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg
))
sd(CombByDate$Spec3Ret, na.rm = TRUE)
CombByDate$Spec3Ret
View(CombByDate)
View(FundPRes)
with(FundPRes, {
Spec3Ret <- c(NA, Mid.SKSPEC3[2:n]/Mid.SKSPEC3[1:n-1]-1)
Spec4Ret <- c(NA, Mid.SKSPEC4[2:n]/Mid.SKSPEC4[1:n-1]-1)
Spec5Ret <- c(NA, Mid.SKSPEC5[2:n]/Mid.SKSPEC5[1:n-1]-1)
Spec6Ret <- c(NA, Mid.SKSPEC6[2:n]/Mid.SKSPEC6[1:n-1]-1)
Spec7Ret <- c(NA, Mid.SKSPEC7[2:n]/Mid.SKSPEC7[1:n-1]-1)
Spec8Ret <- c(NA, Mid.SKSPEC8[2:n]/Mid.SKSPEC8[1:n-1]-1)
})
rm(list =ls(all=TRUE))
FundPrices <- read.csv("CitiPrices.csv", header = TRUE)
FundPrices$Date <- as.Date(FundPrices$Date, "%d/%m/%Y")
SectorRet <- read.csv("IMAreturns1504.csv", header = TRUE)
SectorRet$Date <- as.Date(SectorRet$Date, "%d-%b-%y")
#################################################################
# Sector returns in percentage terms
SectorRet[, 2:dim(SectorRet)[2]] <- SectorRet[, 2:dim(SectorRet)[2]]/100
#################################################################
# Spectrum funds by columns on date - mid only
FundPRes <- reshape(FundPrices[FundPrices$Class == "OA",],
drop = c("Class", "SwingBasis", "Bid", "Offer"),
idvar = c("Date"),
timevar = "Fund",
direction = "wide")
rownames(FundPRes) <- FundPRes$Date
n <- nrow(FundPRes)
with(FundPRes, {
Spec3Ret <- c(NA, Mid.SKSPEC3[2:n]/Mid.SKSPEC3[1:n-1]-1)
Spec4Ret <- c(NA, Mid.SKSPEC4[2:n]/Mid.SKSPEC4[1:n-1]-1)
Spec5Ret <- c(NA, Mid.SKSPEC5[2:n]/Mid.SKSPEC5[1:n-1]-1)
Spec6Ret <- c(NA, Mid.SKSPEC6[2:n]/Mid.SKSPEC6[1:n-1]-1)
Spec7Ret <- c(NA, Mid.SKSPEC7[2:n]/Mid.SKSPEC7[1:n-1]-1)
Spec8Ret <- c(NA, Mid.SKSPEC8[2:n]/Mid.SKSPEC8[1:n-1]-1)
})
CombByDate <-merge(FundPRes, SectorRet, by = "Date", all = FALSE)
rownames(CombByDate) <- CombByDate$Date
firstDate <- min(CombByDate$Date)
lastDate <- max(CombByDate$Date)
with(FundPRes,
Spec3Ret <- c(NA, Mid.SKSPEC3[2:n]/Mid.SKSPEC3[1:n-1]-1)
Spec4Ret <- c(NA, Mid.SKSPEC4[2:n]/Mid.SKSPEC4[1:n-1]-1)
Spec5Ret <- c(NA, Mid.SKSPEC5[2:n]/Mid.SKSPEC5[1:n-1]-1)
Spec6Ret <- c(NA, Mid.SKSPEC6[2:n]/Mid.SKSPEC6[1:n-1]-1)
Spec7Ret <- c(NA, Mid.SKSPEC7[2:n]/Mid.SKSPEC7[1:n-1]-1)
Spec8Ret <- c(NA, Mid.SKSPEC8[2:n]/Mid.SKSPEC8[1:n-1]-1)
)
with(FundPRes,
Spec3Ret <- c(NA, Mid.SKSPEC3[2:n]/Mid.SKSPEC3[1:n-1]-1))
View(FundPRes)
FundPRes$Spec3Ret <- c(NA, FundPRes$Mid.SKSPEC3[2:n]/FundPRes$Mid.SKSPEC3[1:n-1]-1))
FundPRes$Spec3Ret <- c(NA, FundPRes$Mid.SKSPEC3[2:n]/FundPRes$Mid.SKSPEC3[1:n-1]-1)
rm(list =ls(all=TRUE))
FundPrices <- read.csv("CitiPrices.csv", header = TRUE)
FundPrices$Date <- as.Date(FundPrices$Date, "%d/%m/%Y")
SectorRet <- read.csv("IMAreturns1504.csv", header = TRUE)
SectorRet$Date <- as.Date(SectorRet$Date, "%d-%b-%y")
#################################################################
# Sector returns in percentage terms
SectorRet[, 2:dim(SectorRet)[2]] <- SectorRet[, 2:dim(SectorRet)[2]]/100
#################################################################
# Spectrum funds by columns on date - mid only
FundPRes <- reshape(FundPrices[FundPrices$Class == "OA",],
drop = c("Class", "SwingBasis", "Bid", "Offer"),
idvar = c("Date"),
timevar = "Fund",
direction = "wide")
rownames(FundPRes) <- FundPRes$Date
n <- nrow(FundPRes)
FundPRes$Spec3Ret <- c(NA, FundPRes$Mid.SKSPEC3[2:n]/FundPRes$Mid.SKSPEC3[1:n-1]-1)
FundPRes$Spec4Ret <- c(NA, FundPRes$Mid.SKSPEC4[2:n]/FundPRes$Mid.SKSPEC4[1:n-1]-1)
FundPRes$Spec5Ret <- c(NA, FundPRes$Mid.SKSPEC5[2:n]/FundPRes$Mid.SKSPEC5[1:n-1]-1)
FundPRes$Spec6Ret <- c(NA, FundPRes$Mid.SKSPEC6[2:n]/FundPRes$Mid.SKSPEC6[1:n-1]-1)
FundPRes$Spec7Ret <- c(NA, FundPRes$Mid.SKSPEC7[2:n]/FundPRes$Mid.SKSPEC7[1:n-1]-1)
FundPRes$Spec8Ret <- c(NA, FundPRes$Mid.SKSPEC8[2:n]/FundPRes$Mid.SKSPEC8[1:n-1]-1)
CombByDate <-merge(FundPRes, SectorRet, by = "Date", all = FALSE)
rownames(CombByDate) <- CombByDate$Date
firstDate <- min(CombByDate$Date)
lastDate <- max(CombByDate$Date)
library(PerformanceAnalytics)
library(Hmisc)
RetSet <- subset(CombByDate, select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg
))
sd(CombByDate$Spec3Ret, na.rm = TRUE)
chart.RiskReturnScatter(RetSet,
add.boxplot = TRUE,
sharpe.ratio = NULL)
sd(CombByDate$Spec3Ret, na.rm = TRUE)*sqrt(252)
sd(CombByDate$Spec8Ret, na.rm = TRUE)*sqrt(252)
StDev.annualized(CombByDate$Spec8Ret)
StdDev.annualized(CombByDate$Spec8Ret)
StdDev.annualized(CombByDate$Spec8Ret, scale = NA)
StdDev.annualized(CombByDate$Spec8Ret, scale = 252)
View(CombByDate)
RetSet <- subset(CombByDate[Date > as.Date("2014-Apr-30")], select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg
))
RetSet <- subset(CombByDate,
Date > as.Date("2014-Apr-30"),
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg
))
RetSet <- subset(CombByDate,
Date > as.Date("30-Apr-2014"),
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg
))
RetSet <- subset(CombByDate,
Date > "30-Apr-2014",
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg
))
RetSet <- subset(CombByDate,
Date > as.Date("30-Apr-14", "%d-%b-%y"),
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg
))
chart.RiskReturnScatter(RetSet,
add.boxplot = TRUE,
sharpe.ratio = NULL)
RetSet <- subset(CombByDate,
Date > as.Date("31-Dec-14", "%d-%b-%y") &
Date < as.Date("1-Apr-15", "%d-%b-%y"),
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg
))
chart.RiskReturnScatter(RetSet,
add.boxplot = TRUE,
sharpe.ratio = NULL)
RetSet <- subset(CombByDate,
Date > as.Date("31-Dec-14", "%d-%b-%y") &
Date <= as.Date("30-Apr-15", "%d-%b-%y"),
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg
))
chart.RiskReturnScatter(RetSet,
add.boxplot = TRUE,
sharpe.ratio = NULL)
RetSet <- subset(CombByDate,
Date > as.Date("30-Apr-14", "%d-%b-%y") &
Date <= as.Date("30-Apr-15", "%d-%b-%y"),
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg
))
chart.RiskReturnScatter(RetSet,
add.boxplot = TRUE,
sharpe.ratio = NULL)
chart.RiskReturnScatter(RetSet,
add.boxplot = TRUE,
add.sharpe = FALSE)
chart.RiskReturnScatter(RetSet,
add.boxplot = TRUE,
add.sharpe = NULL)
chart.RiskReturnScatter(RetSet,
add.boxplot = TRUE,
add.sharpe = c(0))
chart.RiskReturnScatter(RetSet,
add.boxplot = TRUE)
RetSet <- subset(CombByDate,
Date > as.Date("2014-04-30") &
Date <= as.Date("2015-04-30"),
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg
))
chart.Correlation(RetSet, histogram = TRUE)
---
rm(list =ls(all=TRUE))
FundPrices <- read.csv("CitiPrices.csv", header = TRUE)
FundPrices$Date <- as.Date(FundPrices$Date, "%d/%m/%Y")
SectorRet <- read.csv("IMAreturns1504.csv", header = TRUE)
SectorRet$Date <- as.Date(SectorRet$Date, "%d-%b-%y")
#################################################################
# Sector returns in percentage terms
SectorRet[, 2:dim(SectorRet)[2]] <- SectorRet[, 2:dim(SectorRet)[2]]/100
#################################################################
# Spectrum funds by columns on date - mid only
FundPRes <- reshape(FundPrices[FundPrices$Class == "OA",],
drop = c("Class", "SwingBasis", "Bid", "Offer"),
idvar = c("Date"),
timevar = "Fund",
direction = "wide")
rownames(FundPRes) <- FundPRes$Date
n <- nrow(FundPRes)
FundPRes$Spec3Ret <- c(NA, FundPRes$Mid.SKSPEC3[2:n]/FundPRes$Mid.SKSPEC3[1:n-1]-1)
FundPRes$Spec4Ret <- c(NA, FundPRes$Mid.SKSPEC4[2:n]/FundPRes$Mid.SKSPEC4[1:n-1]-1)
FundPRes$Spec5Ret <- c(NA, FundPRes$Mid.SKSPEC5[2:n]/FundPRes$Mid.SKSPEC5[1:n-1]-1)
FundPRes$Spec6Ret <- c(NA, FundPRes$Mid.SKSPEC6[2:n]/FundPRes$Mid.SKSPEC6[1:n-1]-1)
FundPRes$Spec7Ret <- c(NA, FundPRes$Mid.SKSPEC7[2:n]/FundPRes$Mid.SKSPEC7[1:n-1]-1)
FundPRes$Spec8Ret <- c(NA, FundPRes$Mid.SKSPEC8[2:n]/FundPRes$Mid.SKSPEC8[1:n-1]-1)
CombByDate <-merge(FundPRes, SectorRet, by = "Date", all = FALSE)
rownames(CombByDate) <- CombByDate$Date
save(CombByDate, file="CombByDate.Rda")
firstDate <- min(CombByDate$Date)
lastDate <- max(CombByDate$Date)
library(PerformanceAnalytics)
library(PerformanceAnalytics)
library(PerformanceAnalytics)
rm(list =ls(all=TRUE))
load("CombByDate.Rda")
firstDate <- min(CombByDate$Date)
firstDate
lastDate <- max(CombByDate$Date)
lastDate
lastD.ym <- as.yearmon(lastDate)
prevYearEnd <-
as.Date(paste0(as.numeric(format(lastD.ym, "%Y"))-1, "-12-31"))
endOfPrevM <- as.Date(lastD.ym - 1/12, frac = 1)
RetSet1 <- subset(CombByDate,
Date > firstDate &
Date <= lastDate,
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Med,
IMA60Med,
IMA85Med,
IMAfMed
))
RetSet2 <- subset(CombByDate,
Date > as.Date(lastD.ym - 1, frac = 1) &
Date <= lastDate,
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Med,
IMA60Med,
IMA85Med,
IMAfMed
))
RetSet3 <- subset(CombByDate,
Date >  prevYearEnd &
Date <= endOfPrevM,
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Med,
IMA60Med,
IMA85Med,
IMAfMed
))
RetSet4 <- subset(CombByDate,
Date >  prevYearEnd & Date <= lastDate,
select = c(Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
IMA35Med,
IMA60Med,
IMA85Med,
IMAfMed
))
.pardefault <- par()
par(mfrow = c(2,2), mar= c(3,3,2,1))
chart.RiskReturnScatter(RetSet1,
add.boxplot = TRUE)
chart.RiskReturnScatter(RetSet2,
add.boxplot = TRUE)
chart.RiskReturnScatter(RetSet3,
add.boxplot = TRUE)
chart.RiskReturnScatter(RetSet4,
add.boxplot = TRUE)
par(.pardefault)
par(mfrow = c(2,2), mar= c(3,3,2,1))
chart.RiskReturnScatter(RetSet1,
add.boxplot = FALSE,
main = "")
chart.RiskReturnScatter(RetSet2,
add.boxplot = FALSE,
main = "")
chart.RiskReturnScatter(RetSet3,
add.boxplot = FALSE,
main = "")
chart.RiskReturnScatter(RetSet4,
add.boxplot = FALSE,
main = "")
par(.pardefault)
.pardefault <- par()
par(mfrow = c(2,2), mar= c(3,3,2,1))
chart.RiskReturnScatter(RetSet1,
add.boxplot = TRUE,
main = "")
chart.RiskReturnScatter(RetSet2,
add.boxplot = TRUE,
main = "")
chart.RiskReturnScatter(RetSet3,
add.boxplot = TRUE,
main = "")
chart.RiskReturnScatter(RetSet4,
add.boxplot = TRUE,
main = "")
par(.pardefault)
require(PerformanceAnalytics, quietly=TRUE, warn.conflicts = FALSE)
```{r restoreDefs, message=FALSE}
.pardefault <- par()
par(mfrow = c(2,3), mar= c(3,3,2,1))
boxplot(CombByDate$Spec3Ret, main = "Spectrum 3")
boxplot(CombByDate$Spec4Ret, main = "Spectrum 4")
boxplot(CombByDate$Spec5Ret, main = "Spectrum 5")
boxplot(CombByDate$Spec6Ret, main = "Spectrum 6")
boxplot(CombByDate$Spec7Ret, main = "Spectrum 7")
boxplot(CombByDate$Spec8Ret, main = "Spectrum 8")
par(mfrow = c(2,2), mar= c(3,3,2,1))
boxplot(CombByDate$IMA35Med, main = "IMA med 0-35")
boxplot(CombByDate$IMA60Med, main = "IMA med 20-60")
boxplot(CombByDate$IMA85Med, main = "IMA med 40-85")
boxplot(CombByDate$IMAfMed, main = "IMA med Flex")
par(mfrow = c(2,2), mar= c(3,3,2,1))
boxplot(CombByDate$IMA35Med, main = "IMA avg 0-35")
boxplot(CombByDate$IMA60Med, main = "IMA avg 20-60")
boxplot(CombByDate$IMA85Med, main = "IMA avg 40-85")
boxplot(CombByDate$IMAfMed, main = "IMA avg Flex")
par(.pardefault)
\centering
```{r SpecVsAvg, echo=FALSE, fig.align='center', fig.width=10, fig.height=8}
```{r SpecVsAvg, echo=FALSE, fig.align='center', fig.width=9, fig.height=6}
RetSetSec <- subset(CombByDate,
Date > firstDate &
Date <= lastDate,
select = c(IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg,
IMA35Med,
IMA60Med,
IMA85Med,
IMAfMed
))
chart.RiskReturnScatter(RetSetSec,
add.boxplot = FALSE,
main="Sectors median & average returns"
)
library(PerformanceAnalytics)
firstDate <- min(CombByDate$Date)
lastDate <- max(CombByDate$Date)
RetSetSec <- subset(CombByDate,
Date > firstDate &
Date <= lastDate,
select = c(IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg,
IMA35Med,
IMA60Med,
IMA85Med,
IMAfMed
))
chart.RiskReturnScatter(RetSetSec,
add.boxplot = FALSE,
main="Sectors median & average returns"
)
fix(firstDate)
library(PerformanceAnalytics)
rm(list =ls(all=TRUE))
load("CombByDate.Rda")
firstDate <- min(CombByDate$Date)
lastDate <- max(CombByDate$Date)
RetSetSec <- subset(CombByDate,
Date > firstDate &
Date <= lastDate,
select = c(IMA35Avg,
IMA60Avg,
IMA85Avg,
IMAfAvg,
IMA35Med,
IMA60Med,
IMA85Med,
IMAfMed
))
chart.RiskReturnScatter(RetSetSec,
add.boxplot = FALSE,
main="Sectors median & average returns"
)
chart.RiskReturnScatter(RetSetSec,
add.boxplot = FALSE,
main="Sectors median & average returns",
pch=15
)
chart.RiskReturnScatter(RetSetSec,
add.boxplot = FALSE,
main="Sectors median & average returns",
pch=rep(15,8)
)
chart.RiskReturnScatter(RetSetSec,
add.boxplot = FALSE,
main="Sectors median & average returns",
col=rep("red",8)
)
chart.RiskReturnScatter(RetSetSec,
add.boxplot = FALSE,
main="Sectors median & average returns",
col=c(rep("blue", 4), rep("red",4))
)
