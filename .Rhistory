colnames(RollFuExpAv)[1] <- "Date"
RollFuExpAv$Date <- as.Date(RollFuExpAv$Date)
EquityExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="BySecGroup" &
SpecExpSet$Typ == "Equities"&
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(EquityExp) <- c("Date",
"Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")
RollEqExpAv <- data.frame(cbind(EquityExp$Date,
rollapplyr(EquityExp[c("Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")],
RollingObs, mean, fill=NA)))
colnames(RollEqExpAv)[1] <- "Date"
RollEqExpAv$Date <- as.Date(RollEqExpAv$Date)
###########################
## Pick the "right" exposure variable
## RollFuExAv for equity funds exposure
## RollEqExAv for equity exposure
ExpRollMelt <- melt(RollFuExpAv, id.var = c("Date"), value.name = "Exposure")
ExpRollMelt$variable <- substr(ExpRollMelt$variable, 1, 5)
###########################
Returns <- subset(CombByDate, select = c(Date,
Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
VIX)
)
RollRetSd <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("Spec3Ret",
"Spec4Ret",
"Spec5Ret",
"Spec6Ret",
"Spec7Ret",
"Spec8Ret")],
RollingObs, sd, fill=NA)))
colnames(RollRetSd)[1] <- "Date"
RollRetSd$Date <- as.Date(RollRetSd$Date)
RetSdRollMelt <- melt(RollRetSd, id.var=c("Date"), value.name = "SdRet")
RetSdRollMelt$variable <- substr(RetSdRollMelt$variable, 1, 5)
############
VIXdf <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("VIX")],
RollingObs, mean, fill=NA)))
colnames(VIXdf)[1] <- "Date"
VIXdf$Date <- as.Date(VIXdf$Date)
############
RegSet <- merge(ExpRollMelt, RetSdRollMelt, by = c("Date", "variable"))
RegSet <- merge(RegSet, VIXdf, by = "Date")
View(RegSet)
summary(lm(SdRet ~ Exposure + VIX, data = RegSet))
RegSet$VixCut <- cut(RegSet$VIX, 3, labels = c("low", "mid", "hi"))
View(RegSet)
summary(lm(SdRet ~ Exposure + VixCut, data = RegSet))
ggplot(RegSet, aes(x=Exposure, y = SdRet
, colour = factor(VixCut)
)) +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
library(ggplot2)
ggplot(RegSet, aes(x=Exposure, y = SdRet
, colour = factor(VixCut)
)) +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
ggplot(RegSet, aes(x=Exposure, y = SdRet
, colour = factor(VixCut))) +
geom_smooth(method="lm") +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
ggplot(RegSet, aes(x=Exposure, y = SdRet
, colour = factor(VixCut))) +
geom_smooth(method="lm") +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
ggplot(RegSet, aes(x=Exposure, y = SdRet)) +
geom_smooth(method="lm") +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
ggplot(RegSet, aes(x=Exposure, y = SdRet
, colour = factor(VixCut))) +
geom_smooth(method="lm") +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
ggplot(data = dataset ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
facet_wrap(~ Fund)
library(ggplot2)
library(scales)
dataset <- SpecExpSet[SpecExpSet$Class == "ByFundType" &
SpecExpSet$Calc == "NetExp" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
c("DetsDate", "Val", "Fund", "Typ")]
rownames(dataset) <- NULL
ggplot(data = dataset ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
facet_wrap(~ Fund)
View(dataset)
ggplot(data = dataset ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
facet_wrap(~ Fund)
ggplot(data = dataset ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
facet_wrap(~ Fund)
ggplot(data = dataset ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
#scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels = percent) +
facet_wrap(~ Fund)
ggplot(data = dataset ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
#scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels = percent) +
facet_wrap(~ Fund)
ggplot(data = dataset ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
#scale_fill_brewer(palette="Greens") +
#scale_y_continuous(labels = percent) +
facet_wrap(~ Fund)
ggplot(data = dataset ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
facet_wrap(~ Fund)
ggplot(data = dataset ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
facet_wrap(~ Fund)
ggplot(data = dataset ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
facet_wrap(~ Fund)
dataset <- SpecExpSet[SpecExpSet$Class == "ByFundType" &
SpecExpSet$Calc == "NetExp" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
c("DetsDate", "Val", "Fund", "Typ")]
rownames(dataset) <- NULL
ggplot(data = dataset ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
facet_wrap(~ Fund)
library(ggplot2)
library(scales)
FundExpTypeSet <- SpecExpSet[SpecExpSet$Class == "ByFundType" &
SpecExpSet$Calc == "NetExp" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
c("DetsDate", "Val", "Fund", "Typ")]
rownames(FundExpTypeSet) <- NULL
ggplot(data = FundExpTypeSet ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels = percent) +
facet_wrap(~ Fund)
View(dataset)
anyNA(FundExpTypeSet)
is.na(FundExpTypeSet)
is.na(FundExpTypeSet) <- 0
FundExpTypeSet[is.na(FundExpTypeSet)] <- 0
anyNA(FundExpTypeSet)
ggplot(data = FundExpTypeSet ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels = percent) +
facet_wrap(~ Fund)
FundExpTypeSet <- SpecExpSet[SpecExpSet$Class == "ByFundType" &
SpecExpSet$Calc == "NetExp" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
c("DetsDate", "Val", "Fund", "Typ")]
rownames(FundExpTypeSet) <- NULL
FundExpTypeSet[is.na(FundExpTypeSet)]
FundExpTypeSet[is.na(FundExpTypeSet),]
FundExpTypeSet <- SpecExpSet[SpecExpSet$Class == "ByFundType" &
SpecExpSet$Calc == "NetExp" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
c("DetsDate", "Val", "Fund", "Typ")]
rownames(FundExpTypeSet) <- NULL
ggplot(data = FundExpTypeSet ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ, na.rm = TRUE), position = 'stack') +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels = percent) +
facet_wrap(~ Fund)
ggplot(data = FundExpTypeSet[!is.na(FundExpTypeSet)] ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels = percent) +
facet_wrap(~ Fund)
FundExpTypeSet[!is.na(FundExpTypeSet)]
ggplot(data = FundExpTypeSet[complete.cases(FundExpTypeSet),] ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels = percent) +
facet_wrap(~ Fund)
View(SpecExpSet)
FundExpTypeSet <- SpecExpSet[SpecExpSet$Class == "ByFundType" &
SpecExpSet$Calc == "RiskShare" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
c("DetsDate", "Val", "Fund", "Typ")]
rownames(FundExpTypeSet) <- NULL
ggplot(data = FundExpTypeSet[complete.cases(FundExpTypeSet),] ,
aes(DetsDate,  Val)) +
geom_area(aes(colour = Typ, fill = Typ), position = 'stack') +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels = percent) +
facet_wrap(~ Fund)
library(reshape2)
library(PerformanceAnalytics)
rm(list =ls(all=TRUE))
load("SpecExpSet.Rda")
load("CombByDate.Rda")
RollingObs <- 22
FundsExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="ByFundType" &
SpecExpSet$Typ == "Equity Fund" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(FundsExp) <- c("Date",
"Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")
FundsExp <- FundsExp[complete.cases(FundsExp),]
RollFuExpAv <- data.frame(cbind(FundsExp$Date,
rollapplyr(FundsExp[c("Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")],
RollingObs, mean, fill=NA)))
colnames(RollFuExpAv)[1] <- "Date"
RollFuExpAv$Date <- as.Date(RollFuExpAv$Date)
EquityExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="BySecGroup" &
SpecExpSet$Typ == "Equities"&
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(EquityExp) <- c("Date",
"Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")
EquityExp <- FundsExp[complete.cases(EquityExp),]
RollEqExpAv <- data.frame(cbind(EquityExp$Date,
rollapplyr(EquityExp[c("Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")],
RollingObs, mean, fill=NA)))
colnames(RollEqExpAv)[1] <- "Date"
RollEqExpAv$Date <- as.Date(RollEqExpAv$Date)
###########################
## Pick the "right" exposure variable
## RollFuExAv for equity funds exposure
## RollEqExAv for equity exposure
ExpRollMelt <- melt(RollFuExpAv, id.var = c("Date"), value.name = "Exposure")
ExpRollMelt$variable <- substr(ExpRollMelt$variable, 1, 5)
###########################
Returns <- subset(CombByDate, select = c(Date,
Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
VIX)
)
RollRetSd <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("Spec3Ret",
"Spec4Ret",
"Spec5Ret",
"Spec6Ret",
"Spec7Ret",
"Spec8Ret")],
RollingObs, sd, fill=NA)))
colnames(RollRetSd)[1] <- "Date"
RollRetSd$Date <- as.Date(RollRetSd$Date)
RetSdRollMelt <- melt(RollRetSd, id.var=c("Date"), value.name = "SdRet")
RetSdRollMelt$variable <- substr(RetSdRollMelt$variable, 1, 5)
############
VIXdf <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("VIX")],
RollingObs, mean, fill=NA)))
colnames(VIXdf)[1] <- "Date"
VIXdf$Date <- as.Date(VIXdf$Date)
############
RegSet <- merge(ExpRollMelt, RetSdRollMelt, by = c("Date", "variable"))
RegSet <- merge(RegSet, VIXdf, by = "Date")
library(ggplot2)
#library(dyn)
#library(lattice)
#RegSet$VixCut <- cut(RegSet$VIX, 3, labels = c("low", "mid", "hi"))
RegSet$VixCut <- cut(RegSet$VIX, 3)
#boxplot(FundsExp[,-1], las = 2)
ggplot(ExpRollMelt, aes(x=variable, y = Exposure)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
xlab("Funds")
ggplot(RetSdRollMelt, aes(x=variable, y = SdRet)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
xlab("Funds")
ggplot(RegSet, aes(x=Exposure, y = SdRet
, colour = factor(VixCut)
)) +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
ggplot(RegSet, aes(x=Exposure, y = SdRet)) +
geom_smooth(method="lm") +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
ggplot(RegSet, aes(x=Exposure, y = SdRet
, colour = factor(VixCut))) +
geom_smooth(method="lm") +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
#xyplot(SdRet ~ Exposure | variable, data = RegSet)
summary(lm(SdRet ~ Exposure + VIX, data = RegSet))
library(reshape2)
library(PerformanceAnalytics)
rm(list =ls(all=TRUE))
load("SpecExpSet.Rda")
load("CombByDate.Rda")
RollingObs <- 20
FundsExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="ByFundType" &
SpecExpSet$Typ == "Equity Fund" &
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(FundsExp) <- c("Date",
"Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")
FundsExp <- FundsExp[complete.cases(FundsExp),]
RollFuExpAv <- data.frame(cbind(FundsExp$Date,
rollapplyr(FundsExp[c("Spec3EqFuExp",
"Spec4EqFuExp",
"Spec5EqFuExp",
"Spec6EqFuExp",
"Spec7EqFuExp",
"Spec8EqFuExp")],
RollingObs, mean, fill=NA)))
colnames(RollFuExpAv)[1] <- "Date"
RollFuExpAv$Date <- as.Date(RollFuExpAv$Date)
EquityExp <- reshape(SpecExpSet[SpecExpSet$Calc == "NetExp" &
SpecExpSet$Class =="BySecGroup" &
SpecExpSet$Typ == "Equities"&
SpecExpSet$DetsDate != as.Date("2014-12-12"),
],
drop = c("Typ", "Class", "Calc"),
idvar = c("DetsDate"),
timevar = "Fund",
direction = "wide")
names(EquityExp) <- c("Date",
"Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")
EquityExp <- FundsExp[complete.cases(EquityExp),]
RollEqExpAv <- data.frame(cbind(EquityExp$Date,
rollapplyr(EquityExp[c("Spec3EqExp",
"Spec4EqExp",
"Spec5EqExp",
"Spec6EqExp",
"Spec7EqExp",
"Spec8EqExp")],
RollingObs, mean, fill=NA)))
colnames(RollEqExpAv)[1] <- "Date"
RollEqExpAv$Date <- as.Date(RollEqExpAv$Date)
###########################
## Pick the "right" exposure variable
## RollFuExAv for equity funds exposure
## RollEqExAv for equity exposure
ExpRollMelt <- melt(RollFuExpAv, id.var = c("Date"), value.name = "Exposure")
ExpRollMelt$variable <- substr(ExpRollMelt$variable, 1, 5)
###########################
Returns <- subset(CombByDate, select = c(Date,
Spec3Ret,
Spec4Ret,
Spec5Ret,
Spec6Ret,
Spec7Ret,
Spec8Ret,
VIX)
)
RollRetSd <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("Spec3Ret",
"Spec4Ret",
"Spec5Ret",
"Spec6Ret",
"Spec7Ret",
"Spec8Ret")],
RollingObs, sd, fill=NA)))
colnames(RollRetSd)[1] <- "Date"
RollRetSd$Date <- as.Date(RollRetSd$Date)
RetSdRollMelt <- melt(RollRetSd, id.var=c("Date"), value.name = "SdRet")
RetSdRollMelt$variable <- substr(RetSdRollMelt$variable, 1, 5)
############
VIXdf <- data.frame(cbind(Returns$Date,
rollapplyr(Returns[c("VIX")],
RollingObs, mean, fill=NA)))
colnames(VIXdf)[1] <- "Date"
VIXdf$Date <- as.Date(VIXdf$Date)
############
RegSet <- merge(ExpRollMelt, RetSdRollMelt, by = c("Date", "variable"))
RegSet <- merge(RegSet, VIXdf, by = "Date")
library(ggplot2)
#library(dyn)
#library(lattice)
#RegSet$VixCut <- cut(RegSet$VIX, 3, labels = c("low", "mid", "hi"))
RegSet$VixCut <- cut(RegSet$VIX, 3)
#boxplot(FundsExp[,-1], las = 2)
ggplot(ExpRollMelt, aes(x=variable, y = Exposure)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
xlab("Funds")
ggplot(RetSdRollMelt, aes(x=variable, y = SdRet)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
xlab("Funds")
ggplot(RegSet, aes(x=Exposure, y = SdRet
, colour = factor(VixCut)
)) +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
ggplot(RegSet, aes(x=Exposure, y = SdRet)) +
geom_smooth(method="lm") +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
ggplot(RegSet, aes(x=Exposure, y = SdRet
, colour = factor(VixCut))) +
geom_smooth(method="lm") +
geom_point(shape=1) +    # Use hollow circles
labs(x = "Eq.Funds exposure", y = "StDev of returns") +
ggtitle(paste("Rolling", RollingObs, "observations"))
#xyplot(SdRet ~ Exposure | variable, data = RegSet)
summary(lm(SdRet ~ Exposure + VIX, data = RegSet))
View(CombByDate)
View(RegSet)
SDonEXP <- lm(SdRet ~ Exposure, data = RegSet)
summary(SDonEXP)
SDonEXP <- lm(SdRet ~ Exposure, data = RegSet)
summary(SDonEXP)
install.packages(c("PerformanceAnalytics", "scales", "plyr", "reshape2", "ggplot2"))
SIDec14 = c(0.496, 0.621, 0.758, 0.897, 0.1049, 0.1233))
SpecTgtVol <- data.frame(Fund = c("Spec3", "Spec4","Spec5","Spec6","Spec7","Spec8"),
Min = c(0.0575, 0.0786, 0.0957, 0.1129, 0.13, 0.1472),
Max = c(0.0785, 0.0956, 0.1128, 0.1299, 0.1471, 0.1643),
SIDec14 = c(0.496, 0.621, 0.758, 0.897, 0.1049, 0.1233))
View(SpecTgtVol)
View(RegSet)
View(RollRetSd)
